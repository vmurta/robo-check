# project
rai:
  version: 0.2
  image: raiproject/pumps2018:amd64-cuda100
resources:
  cpu:
    architecture: ppc64le
  gpu:
    count: 1
  network: false
  cache: false
commands:
  build:
    - cp -r /src .
    # - nvcc -c /src/generate-AABB/generate-AABB.cu -o generate-AABB.o
    # - nvcc -c /src/generate-AABB/test-generate-AABB.cu -o test-generate-AABB.o
    # - nvcc generate-AABB.o test-generate-AABB.o -o test-generate-AABB
    # - ./test-generate-AABB
    #- nvcc -c /src/broad-phase/broad-phase.cu -o broad-phase.o
    #- nvcc broad-phase.o -o test-broad-phase
    #- ./test-broad-phase
    # - nvcc -c /src/narrow-phase/narrow-phase.cu -o narrow-phase.o
    # - nvcc -c /src/narrow-phase/test-narrow-phase.cu -o test-narrow-phase.o
    # - nvcc narrow-phase.o test-narrow-phase.o -o test-narrow-phase
    # - ./test-narrow-phase
    # =====
    - nvcc -c /src/generate-AABB/generate-AABB.cu -o generate-AABB.o
    - nvcc -c /src/transformation/transform.cu -o transform.o
    - nvcc -c /src/broad-phase/broad-phase.cu -o broad-phase.o
    - nvcc -c /src/test/integration-test.cu -o integration-test.o
    - nvcc -c /src/Utils_rai.cu -o Utils_rai.o
    - nvcc broad-phase.o generate-AABB.o integration-test.o transform.o Utils_rai.o -o integration-test
    - ./integration-test
